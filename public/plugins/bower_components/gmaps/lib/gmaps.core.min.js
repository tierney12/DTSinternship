if(!(typeof window.google==="object"&&window.google.maps)){throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."}var extend_object=function(b,c){var a;if(b===c){return b}for(a in c){b[a]=c[a]}return b};var replace_object=function(c,b){var a;if(c===b){return c}for(a in b){if(c[a]!=undefined){c[a]=b[a]}}return c};var array_map=function(f,e){var b=Array.prototype.slice.call(arguments,2),d=[],a=f.length,c;if(Array.prototype.map&&f.map===Array.prototype.map){d=Array.prototype.map.call(f,function(h){var g=b.slice(0);g.splice(0,0,h);return e.apply(this,g)})}else{for(c=0;c<a;c++){callback_params=b;callback_params.splice(0,0,f[c]);d.push(e.apply(this,callback_params))}}return d};var array_flat=function(c){var b=[],a;for(a=0;a<c.length;a++){b=b.concat(c[a])}return b};var coordsToLatLngs=function(b,c){var d=b[0],a=b[1];if(c){d=b[1];a=b[0]}return new google.maps.LatLng(d,a)};var arrayToLatLng=function(b,c){var a;for(a=0;a<b.length;a++){if(!(b[a] instanceof google.maps.LatLng)){if(b[a].length>0&&typeof(b[a][0])==="object"){b[a]=arrayToLatLng(b[a],c)}else{b[a]=coordsToLatLngs(b[a],c)}}}return b};var getElementsByClassName=function(d,c){var b,a=d.replace(".","");if("jQuery" in this&&c){b=$("."+a,c)[0]}else{b=document.getElementsByClassName(a)[0]}return b};var getElementById=function(c,b){var a,c=c.replace("#","");if("jQuery" in window&&b){a=$("#"+c,b)[0]}else{a=document.getElementById(c)}return a};var findAbsolutePosition=function(b){var c=0,a=0;if(b.offsetParent){do{c+=b.offsetLeft;a+=b.offsetTop}while(b=b.offsetParent)}return[c,a]};var GMaps=(function(b){var c=document;var a=function(k){if(!this){return new a(k)}k.zoom=k.zoom||15;k.mapType=k.mapType||"roadmap";var z=this,B,m=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],q=["mousemove","mouseout","mouseover"],s=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],h=k.el||k.div,o=k.markerClusterer,C=google.maps.MapTypeId[k.mapType.toUpperCase()],x=new google.maps.LatLng(k.lat,k.lng),F=k.zoomControl||true,e=k.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},A=e.style||"DEFAULT",f=e.position||"TOP_LEFT",t=k.panControl||true,n=k.mapTypeControl||true,r=k.scaleControl||true,p=k.streetViewControl||true,l=l||true,y={},v={zoom:this.zoom,center:x,mapTypeId:C},d={panControl:t,zoomControl:F,zoomControlOptions:{style:google.maps.ZoomControlStyle[A],position:google.maps.ControlPosition[f]},mapTypeControl:n,scaleControl:r,streetViewControl:p,overviewMapControl:l};if(typeof(k.el)==="string"||typeof(k.div)==="string"){if(h.indexOf("#")>-1){this.el=getElementById(h,k.context)}else{this.el=getElementsByClassName.apply(this,[h,k.context])}}else{this.el=h}if(typeof(this.el)==="undefined"||this.el===null){throw"No element defined."}window.context_menu=window.context_menu||{};window.context_menu[z.el.id]={};this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=k.zoom;this.registered_events={};this.el.style.width=k.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=k.height||this.el.scrollHeight||this.el.offsetHeight;google.maps.visualRefresh=k.enableNewStyle;for(B=0;B<s.length;B++){delete k[s[B]]}if(k.disableDefaultUI!=true){v=extend_object(v,d)}y=extend_object(v,k);for(B=0;B<m.length;B++){delete y[m[B]]}for(B=0;B<q.length;B++){delete y[q[B]]}this.map=new google.maps.Map(this.el,y);if(o){this.markerClusterer=o.apply(this,[this.map])}var u=function(K,P){var O="",T=window.context_menu[z.el.id][K];for(var L in T){if(T.hasOwnProperty(L)){var N=T[L];O+='<li><a id="'+K+"_"+L+'" href="#">'+N.title+"</a></li>"}}if(!getElementById("gmaps_context_menu")){return}var Q=getElementById("gmaps_context_menu");Q.innerHTML=O;var G=Q.getElementsByTagName("a"),S=G.length,L;for(L=0;L<S;L++){var I=G[L];var J=function(i){i.preventDefault();T[this.id.replace(K+"_","")].action.apply(z,[P]);z.hideContextMenu()};google.maps.event.clearListeners(I,"click");google.maps.event.addDomListenerOnce(I,"click",J,false)}var M=findAbsolutePosition.apply(this,[z.el]),H=M[0]+P.pixel.x-15,R=M[1]+P.pixel.y-15;Q.style.left=H+"px";Q.style.top=R+"px";Q.style.display="block"};this.buildContextMenu=function(H,G){if(H==="marker"){G.pixel={};var i=new google.maps.OverlayView();i.setMap(z.map);i.draw=function(){var J=i.getProjection(),I=G.marker.getPosition();G.pixel=J.fromLatLngToContainerPixel(I);u(H,G)}}else{u(H,G)}};this.setContextMenu=function(G){window.context_menu[z.el.id][G.control]={};var I,H=c.createElement("ul");for(I in G.options){if(G.options.hasOwnProperty(I)){var J=G.options[I];window.context_menu[z.el.id][G.control][J.name]={title:J.title,action:J.action}}}H.id="gmaps_context_menu";H.style.display="none";H.style.position="absolute";H.style.minWidth="100px";H.style.background="white";H.style.listStyle="none";H.style.padding="8px";H.style.boxShadow="2px 2px 6px #ccc";c.body.appendChild(H);var K=getElementById("gmaps_context_menu");google.maps.event.addDomListener(K,"mouseout",function(i){if(!i.relatedTarget||!this.contains(i.relatedTarget)){window.setTimeout(function(){K.style.display="none"},400)}},false)};this.hideContextMenu=function(){var i=getElementById("gmaps_context_menu");if(i){i.style.display="none"}};var w=function(G,i){google.maps.event.addListener(G,i,function(H){if(H==undefined){H=this}k[i].apply(this,[H]);z.hideContextMenu()})};google.maps.event.addListener(this.map,"zoom_changed",this.hideContextMenu);for(var D=0;D<m.length;D++){var E=m[D];if(E in k){w(this.map,E)}}for(var D=0;D<q.length;D++){var E=q[D];if(E in k){w(this.map,E)}}google.maps.event.addListener(this.map,"rightclick",function(i){if(k.rightclick){k.rightclick.apply(this,[i])}if(window.context_menu[z.el.id]["map"]!=undefined){z.buildContextMenu("map",i)}});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){var I=[],G=this.markers.length,H;for(H=0;H<G;H++){if(typeof(this.markers[H].visible)==="boolean"&&this.markers[H].visible){I.push(this.markers[H].getPosition())}}this.fitLatLngBounds(I)};this.fitLatLngBounds=function(J){var I=J.length,H=new google.maps.LatLngBounds(),G;for(G=0;G<I;G++){H.extend(J[G])}this.map.fitBounds(H)};this.setCenter=function(G,i,H){this.map.panTo(new google.maps.LatLng(G,i));if(H){H()}};this.getElement=function(){return this.el};this.zoomIn=function(i){i=i||1;this.zoom=this.map.getZoom()+i;this.map.setZoom(this.zoom)};this.zoomOut=function(i){i=i||1;this.zoom=this.map.getZoom()-i;this.map.setZoom(this.zoom)};var j=[],g;for(g in this.map){if(typeof(this.map[g])=="function"&&!this[g]){j.push(g)}}for(B=0;B<j.length;B++){(function(i,H,G){i[G]=function(){return H[G].apply(H,arguments)}})(this,this.map,j[B])}};return a})(this);