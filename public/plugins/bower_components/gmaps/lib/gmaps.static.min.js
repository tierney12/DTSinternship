GMaps.prototype.toImage=function(b){var b=b||{},d={};d.size=b.size||[this.el.clientWidth,this.el.clientHeight];d.lat=this.getCenter().lat();d.lng=this.getCenter().lng();if(this.markers.length>0){d.markers=[];for(var c=0;c<this.markers.length;c++){d.markers.push({lat:this.markers[c].getPosition().lat(),lng:this.markers[c].getPosition().lng()})}}if(this.polylines.length>0){var a=this.polylines[0];d.polyline={};d.polyline["path"]=google.maps.geometry.encoding.encodePath(a.getPath());d.polyline["strokeColor"]=a.strokeColor;d.polyline["strokeOpacity"]=a.strokeOpacity;d.polyline["strokeWeight"]=a.strokeWeight}return GMaps.staticMapURL(d)};GMaps.staticMapURL=function(b){var g=[],B,c=(location.protocol==="file:"?"http:":location.protocol)+"//maps.googleapis.com/maps/api/staticmap";if(b.url){c=b.url;delete b.url}c+="?";var y=b.markers;delete b.markers;if(!y&&b.marker){y=[b.marker];delete b.marker}var l=b.styles;delete b.styles;var r=b.polyline;delete b.polyline;if(b.center){g.push("center="+b.center);delete b.center}else{if(b.address){g.push("center="+b.address);delete b.address}else{if(b.lat){g.push(["center=",b.lat,",",b.lng].join(""));delete b.lat;delete b.lng}else{if(b.visible){var a=encodeURI(b.visible.join("|"));g.push("visible="+a)}}}}var o=b.size;if(o){if(o.join){o=o.join("x")}delete b.size}else{o="630x300"}g.push("size="+o);if(!b.zoom&&b.zoom!==false){b.zoom=15}var z=b.hasOwnProperty("sensor")?!!b.sensor:true;delete b.sensor;g.push("sensor="+z);for(var h in b){if(b.hasOwnProperty(h)){g.push(h+"="+b[h])}}if(y){var k,m;for(var v=0;B=y[v];v++){k=[];if(B.size&&B.size!=="normal"){k.push("size:"+B.size);delete B.size}else{if(B.icon){k.push("icon:"+encodeURI(B.icon));delete B.icon}}if(B.color){k.push("color:"+B.color.replace("#","0x"));delete B.color}if(B.label){k.push("label:"+B.label[0].toUpperCase());delete B.label}m=(B.address?B.address:B.lat+","+B.lng);delete B.address;delete B.lat;delete B.lng;for(var h in B){if(B.hasOwnProperty(h)){k.push(h+":"+B[h])}}if(k.length||v===0){k.push(m);k=k.join("|");g.push("markers="+encodeURI(k))}else{k=g.pop()+encodeURI("|"+m);g.push(k)}}}if(l){for(var v=0;v<l.length;v++){var n=[];if(l[v].featureType){n.push("feature:"+l[v].featureType.toLowerCase())}if(l[v].elementType){n.push("element:"+l[v].elementType.toLowerCase())}for(var u=0;u<l[v].stylers.length;u++){for(var s in l[v].stylers[u]){var w=l[v].stylers[u][s];if(s=="hue"||s=="color"){w="0x"+w.substring(1)}n.push(s+":"+w)}}var f=n.join("|");if(f!=""){g.push("style="+f)}}}function x(i,j){if(i[0]==="#"){i=i.replace("#","0x");if(j){j=parseFloat(j);j=Math.min(1,Math.max(j,0));if(j===0){return"0x00000000"}j=(j*255).toString(16);if(j.length===1){j+=j}i=i.slice(0,8)+j}}return i}if(r){B=r;r=[];if(B.strokeWeight){r.push("weight:"+parseInt(B.strokeWeight,10))}if(B.strokeColor){var t=x(B.strokeColor,B.strokeOpacity);r.push("color:"+t)}if(B.fillColor){var A=x(B.fillColor,B.fillOpacity);r.push("fillcolor:"+A)}var q=B.path;if(q.join){for(var u=0,e;e=q[u];u++){r.push(e.join(","))}}else{r.push("enc:"+q)}r=r.join("|");g.push("path="+encodeURI(r))}var d=window.devicePixelRatio||1;g.push("scale="+d);g=g.join("&");return c+g};