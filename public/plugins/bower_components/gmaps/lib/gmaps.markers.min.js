GMaps.prototype.createMarker=function(l){if(l.lat==undefined&&l.lng==undefined&&l.position==undefined){throw"No latitude or longitude defined."}var k=this,b=l.details,f=l.fences,h=l.outside,e={position:new google.maps.LatLng(l.lat,l.lng),map:null},c=extend_object(e,l);delete c.lat;delete c.lng;delete c.fences;delete c.outside;var g=new google.maps.Marker(c);g.fences=f;if(l.infoWindow){g.infoWindow=new google.maps.InfoWindow(l.infoWindow);var a=["closeclick","content_changed","domready","position_changed","zindex_changed"];for(var i=0;i<a.length;i++){(function(n,m){if(l.infoWindow[m]){google.maps.event.addListener(n,m,function(o){l.infoWindow[m].apply(this,[o])})}})(g.infoWindow,a[i])}}var j=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"];var d=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"];for(var i=0;i<j.length;i++){(function(n,m){if(l[m]){google.maps.event.addListener(n,m,function(){l[m].apply(this,[this])})}})(g,j[i])}for(var i=0;i<d.length;i++){(function(o,n,m){if(l[m]){google.maps.event.addListener(n,m,function(p){if(!p.pixel){p.pixel=o.getProjection().fromLatLngToPoint(p.latLng)}l[m].apply(this,[p])})}})(this.map,g,d[i])}google.maps.event.addListener(g,"click",function(){this.details=b;if(l.click){l.click.apply(this,[this])}if(g.infoWindow){k.hideInfoWindows();g.infoWindow.open(k.map,g)}});google.maps.event.addListener(g,"rightclick",function(m){m.marker=this;if(l.rightclick){l.rightclick.apply(this,[m])}if(window.context_menu[k.el.id]["marker"]!=undefined){k.buildContextMenu("marker",m)}});if(g.fences){google.maps.event.addListener(g,"dragend",function(){k.checkMarkerGeofence(g,function(n,o){h(n,o)})})}return g};GMaps.prototype.addMarker=function(b){var a;if(b.hasOwnProperty("gm_accessors_")){a=b}else{if((b.hasOwnProperty("lat")&&b.hasOwnProperty("lng"))||b.position){a=this.createMarker(b)}else{throw"No latitude or longitude defined."}}a.setMap(this.map);if(this.markerClusterer){this.markerClusterer.addMarker(a)}this.markers.push(a);GMaps.fire("marker_added",a,this);return a};GMaps.prototype.addMarkers=function(c){for(var b=0,a;a=c[b];b++){this.addMarker(a)}return this.markers};GMaps.prototype.hideInfoWindows=function(){for(var b=0,a;a=this.markers[b];b++){if(a.infoWindow){a.infoWindow.close()}}};GMaps.prototype.removeMarker=function(a){for(var b=0;b<this.markers.length;b++){if(this.markers[b]===a){this.markers[b].setMap(null);this.markers.splice(b,1);if(this.markerClusterer){this.markerClusterer.removeMarker(a)}GMaps.fire("marker_removed",a,this);break}}return a};GMaps.prototype.removeMarkers=function(e){var a=[];if(typeof e=="undefined"){for(var d=0;d<this.markers.length;d++){var b=this.markers[d];b.setMap(null);if(this.markerClusterer){this.markerClusterer.removeMarker(b)}GMaps.fire("marker_removed",b,this)}this.markers=a}else{for(var d=0;d<e.length;d++){var c=this.markers.indexOf(e[d]);if(c>-1){var b=this.markers[c];b.setMap(null);if(this.markerClusterer){this.markerClusterer.removeMarker(b)}GMaps.fire("marker_removed",b,this)}}for(var d=0;d<this.markers.length;d++){var b=this.markers[d];if(b.getMap()!=null){a.push(b)}}this.markers=a}};