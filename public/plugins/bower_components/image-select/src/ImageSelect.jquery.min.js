(function(d){var c='<img class="{class_name}" src="{url}" />';function a(h,j,i,k,f,g){var l=d(j).data("img-src");if(l!=undefined&&l>""){h=d(h);text=d(j).text();f=(f!=undefined)?f:true;g=g||(f?"chose-image":"chose-image-small");g=k?g+" rtl":g;i=i.replace("{url}",l).replace("{class_name}",g).replace("{text}",text);h.empty();if(k&&f){h.append(i)}else{h.prepend(i)}}}function e(f){var g=[];var k=d(f.form_field).find("option:selected")||[];var m=(f.is_multiple)?d(f.container).find(".chosen-choices span"):d(f.container).find(".chosen-single span");for(var l=0;l<k.length;l++){for(var h=0;h<m.length;h++){if(d(m[h]).text()==d(k[l]).text()){g.push({span:m[h],option:k[l]})}}}return g}var b=d.fn.chosen;d.fn.extend({chosen:function(g){g=g||{};var f=b.apply(this,arguments);this.each(function(){var i=d(this),h=i.data("chosen");i.on("chosen:hiding_dropdown",function(r,m){var n=e(m.chosen);var q=m.chosen.is_rtl;var l=m.chosen.is_multiple;var p=g.html_template||(q&&l?"{text}"+c:c+"{text}");for(var o=0;o<n.length;o++){a(n[o].span,n[o].option,p,q,l)}});i.on("chosen:showing_dropdown",function j(r,n){var n=n.chosen;var u=n.form_field.options||[];var p=n.is_rtl;var o=g.html_template||(p?"{text}"+c:c+"{text}");var t=d(n.container).find(".chosen-drop ul li:not(:has(img))");for(var l=0;l<t.length;l++){var s=t[l];var m=d(u[l]);var q=d(s).attr("data-option-array-index");if(q){m=u[n.results_data[q].options_index];a(s,m,o,p,true,"chose-image-list")}}});i.on("chosen:ready",function k(m,l){i.trigger("chosen:hiding_dropdown",l)});i.on("chosen:updated",function k(l){i.trigger("chosen:hiding_dropdown",{chosen:h})});i.on("chosen:filter",function(m,l){i.trigger("chosen:showing_dropdown",{chosen:l.chosen})});if(typeof h!="undefined"){i.trigger("chosen:hiding_dropdown",{chosen:h})}});return d(this)}})})(jQuery);